{% extends "club/base.html" %}

{% block content %}
<section class="hero is-primary">
    <div class="hero-body">
        <div class="container">
            <h1 class="title">Club Events</h1>
            <h2 class="subtitle">We host workshops, code jams, speaker sessions and more!</h2>
        </div>
    </div>
</section>
<section class="section event-index">
    <div class="container">
        {% include 'club/includes/messages.html' %}

        <h1 id="upcoming" class="title">
            <a href="#upcoming">Upcoming</a>
        </h1>
        <div class="columns">
            <div class="column is-half">
                {% for event in upcoming_events %}
                <div class="box media event-summary">
                    <div class="media-left">
                        <p class="image is-128x128" style="display: flex; align-items: center;">
                            {% if event.thumbnail_link %}
                            <a title="Event slideshow" target="_blank" href="{{ event.slideshow_link }}">
                                <img alt="Thumbail for event slideshow" src="{{ event.thumbnail_link }}">
                            </a>
                            {% endif %}
                        </p>
                    </div>
                    <div class="media-body">
                        <a href="{% url 'event_detail' event.id %}">
                            <h3 class="title is-size-4">{{ event.title }}
                                <span class="has-text-grey">{{ event.get_event_type_display }}</span>
                            </h3>
                        </a>
                        {% if event.tagline %}
                        <h4 class="subtitle"><em>{{ event.tagline }}</em></h4>
                        {% endif %}

                        <a href="https://maps.google.com/?q={{ event.location|urlencode }}"
                            title="This event is being held in {{ event.location }}" target="_blank"
                            class="event-location">
                            <i class="fas fa-map-marker-alt"></i>
                            {{ event.location }}
                        </a>
                        <span class="event-date-time">{{ event.start }} - {{ event.end }}</span>

                        {% if user.is_staff %}
                        <div class="tags">
                            <span class="tag is-dark">{{ event.rsvps.count }} RSVPs</span>
                            <span class="tag is-info">{{ event.attendance.count }} attendees</span>
                        </div>
                        {% endif %}
                    </div>
                    <!-- <a class="button is-primary" >View</a> -->
                </div>
                {% empty %}
                <p class="has-text-grey is-size-4">
                    There are no upcoming events yet. Stay tuned!
                </p>
                {% endfor %}
            </div>
            <div class="column is-half">
                <iframe
                    src="https://calendar.google.com/calendar/embed?src=scg6hcfie2ebi9bg7ecmj8epn4%40group.calendar.google.com&ctz=America%2FNew_York"
                    style="border: 0" width="100%" height="600" frameborder="0" scrolling="no"></iframe>
            </div>
        </div>

        <hr>

        <h2 id="past" class="title is-size-4">
            <a href="#past">Past Events</a>
        </h2>
        {% if past_events|length > 0 %}
        <table class="table is-fullwidth">
            <thead>
                <tr>
                    <th>When</th>
                    <th>Type</th>
                    <th>Title</th>
                    {% if user.is_staff %}
                    <th>Attendance/RSVPs</th>
                    {% endif %}
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for event in past_events %}
                <tr>
                    <td>{{ event.start }}</td>
                    <td>{{ event.get_event_type_display }}</td>
                    <td>{{ event.title }}</td>
                    {% if user.is_staff %}
                    <td>{{ event.attendance.count }}/{{ event.rsvps.count }}</td>
                    {% endif %}
                    <td>
                        <a href="{% url 'event_detail' event.id %}" class="button is-small is-pulled-right">View</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="has-text-grey">There are no past events.</p>
        {% endif %}
    </div>
</section>

{% endblock %}